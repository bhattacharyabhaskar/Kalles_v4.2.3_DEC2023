{% comment %}
  Template: page.wiki.liquid
  Purpose: To structure SEO-friendly wiki-style content pages (e.g., Saree Encyclopedia) with optional dynamic collection embed.
{% endcomment %}

<!-- Quick patch: include CSS and JS for product image rendering -->
<link rel="stylesheet" href="{{ 'section.css' | asset_url }}">
<link rel="stylesheet" href="{{ 'collection-pages.css' | asset_url }}">
<link rel="stylesheet" href="{{ 'collection-products.css' | asset_url }}">
<link rel="stylesheet" href="{{ 'collection-products-list.css' | asset_url }}">
<link rel="stylesheet" href="{{ 'pagination.css' | asset_url }}">
<link rel="stylesheet" href="{{ 'button-style.css' | asset_url }}">
<link rel="stylesheet" href="{{ 'custom-effect.css' | asset_url }}">
<link rel="stylesheet" href="{{ 'loading.css' | asset_url }}">
<script src="{{ 'lazysizes.min.js' | asset_url }}" async></script>

{% layout 'page' %}


<section class="wiki-page container">
  <div class="wiki-header">
    <h1 class="wiki-title">{{ page.title }}</h1>
  </div>

  <div class="wiki-content">
    {{ page.content }}
  </div>

  {% assign coll_handle = page.metafields.custom.collection_handle %}
  {% if collections[coll_handle] %}
        {% assign col = 't4s-col-lg-3 t4s-col-md-4 t4s-col-6' %}
        {% assign prefix_url = '' %}
        {% assign isGrowaveWishlist = false %}
        {% assign show_img = '2' %}
        {% assign show_vendor = false %}
        {% assign use_link_vendor = true %}
        {% assign enable_pr_color = true %}
        {% assign show_cl_type = '1' %}
        {% assign get_color = 'color' %}
        {% assign enable_pr_size = true %}
        {% assign pr_size_pos = '1' %}
        {% assign get_size = 'size' %}
        {% assign show_size_type = '1' %}
        {% assign price_varies_style = '' %}
        {% assign app_review = '' %}
        {% assign enable_rating = true %}
        {% assign use_countdown = false %}
        {% assign imgatt = 'data-' %}
        {% assign show_list_btns = false %}
        {% assign placeholder_img = settings.placeholder_img %}
    <div class="t4s-container">
      <div class="t4s-row t4s-row-cols-lg-4 t4s-row-cols-md-2 t4s-row-cols-1">
        {% for product in collections[coll_handle].products limit: 4 %}
          <div class="t4s-col-item t4s-col-lg-3 t4s-col-md-6 t4s-col-12">
            {% render 'product-grid-item-wiki', product: product, prefix_url: prefix_url, isGrowaveWishlist: isGrowaveWishlist, show_img: show_img, show_vendor: show_vendor, use_link_vendor: use_link_vendor, enable_pr_color: enable_pr_color, show_cl_type: show_cl_type, get_color: get_color, enable_pr_size: enable_pr_size, pr_size_pos: pr_size_pos, get_size: get_size, show_size_type: show_size_type, price_varies_style: price_varies_style, app_review: app_review, enable_rating: enable_rating, use_countdown: use_countdown, imgatt: imgatt, show_list_btns: show_list_btns, placeholder_img: placeholder_img, col: col %}
          </div>
        {% endfor %}
      </div>
    </div>
  {% endif %}
</section>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    if (window.lazySizes && typeof lazySizes.init === 'function') {
      lazySizes.init();
    }
    document.dispatchEvent(new Event('shopify:section:load'));
    document.dispatchEvent(new Event('theme:section:load'));
  });
</script>
<style>
  .wiki-page {
    padding: 40px 20px;
    max-width: 1000px;
    margin: 0 auto;
    font-family: Georgia, serif;
  }
  .wiki-header {
    text-align: center;
    margin-bottom: 30px;
  }
  .wiki-title {
    font-size: 2rem;
    font-weight: bold;
  }
  .wiki-content h2, .wiki-content h3 {
    margin-top: 32px;
    font-size: 1.5rem;
    border-bottom: 1px solid #ddd;
    padding-bottom: 4px;
  }
  .wiki-content p {
    margin-top: 16px;
    line-height: 1.7;
  }
  .wiki-collection {
    margin-top: 50px;
  }
  .wiki-collection h2 {
    margin-bottom: 20px;
    text-align: center;
  }
  .t4s-product-img {
    display: block;
    width: 100%;
    position: relative;
    overflow: hidden;
  }
  .t4s-product-img img {
    width: 100%;
    height: auto;
    object-fit: cover;
    display: block;
  }
  .t4s-product {
    text-align: center;
    padding: 10px;
  }
</style>